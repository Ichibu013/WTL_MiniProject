<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Login - Online Book Store</title>
    <meta name="description" content="">
    <meta name="keywords" content="">

    <!-- Favicons -->
    <link href="../assets/img/favicon.png" rel="icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Amatic+SC:wght@400;700&display=swap"
          rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="../assets/css/main.css" rel="stylesheet">

  <style>
    .description-title {
      color: #000000;
      font-size: 1.5rem;
      font-weight: 600;
    }
    .description-title:hover {
      color: #000000;
      font-size: 1.5rem;
      font-weight: 600;
    }
  </style>

</head>

<body class="login-page">

<!-- Header -->
<header id="header" class="header d-flex align-items-center sticky-top">
  <div class="container position-relative d-flex align-items-center justify-content-between">
    <a href="../index.html" class="logo d-flex align-items-center me-auto me-xl-0">
      <img src="../assets/img/logobook.jpg" alt="">
      <h1 class="sitename">BookSwamp</h1>
      <span>.</span>
    </a>
  </div>
</header>

<main class="main">
  <section id="customer-sign-in" class="sign-in-form section">

    <!-- Section Title -->
    <div class="container section-title" data-aos="fade-up">
      <h2>Create Your Account</h2>
      <p><span>Access Your</span> <span class="description-title">BookSwamp Account</span></p>
    </div><!-- End Section Title -->

    <div class="container">
      <div class="row g-0" data-aos="fade-up" data-aos-delay="100">

        <!-- Left Side Image -->
        <div class="col-lg-4 reservation-img" style="background-image: url(../assets/img/register.jpg);"></div>

        <!-- Right Side Form -->
        <div class="col-lg-8 d-flex align-items-center reservation-form-bg" data-aos="fade-up" data-aos-delay="200">
          
          <!-- Tabs for Sign-in and Register -->
          <div class="container">
            <br>
            <ul class="nav nav-tabs" id="authTabs">
              <li class="nav-item">
                <a class="nav-link active" id="signInTab" onclick="toggleForm('sign-in')">Sign-in</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="registerTab" onclick="toggleForm('register')">Register</a>
              </li>
            </ul>

            <!-- Sign-in Form -->
            <form id="sign-in-form" class="php-email-form">
              <div class="row gy-4">
                <div class="col-lg-12">
                  <input type="text" class="form-control" name="username" id="username" placeholder="Your Username" required="">
                </div>
                <div class="col-lg-12">
                  <input type="password" class="form-control" name="password" id="password" placeholder="Your Password" required="">
                </div>
              </div>
              <div class="text-center mt-3">
                <button type="submit">Sign In</button>
              </div>
            </form>

            <!-- Register Form -->
            <div id="register-form" class="sign-in-form" style="display: none;">
              <form class="php-email-form">
                <div class="row gy-4">
                  <div class="col-lg-6">
                    <input type="text" name="username" class="form-control" id="register-username" placeholder="Your Username" required>
                  </div>
                  <div class="col-lg-6">
                    <input type="email" class="form-control" name="email" id="register-email" placeholder="Your Email" required>
                  </div>
                  <div class="col-lg-6">
                    <input type="password" class="form-control" name="password" id="register-password" placeholder="Password" required>
                  </div>
                  <div class="col-lg-6">
                    <input type="password" class="form-control" name="confirm-password" id="confirm-password" placeholder="Confirm Password" required>
                  </div>
                </div>
                <div class="text-center mt-3">
                  <button type="submit">Register</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- Scroll Top -->
<a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i
        class="bi bi-arrow-up-short"></i></a>

<!-- Preloader -->
<div id="preloader"></div>

<div id="footer-container" class="footer">
    <!-- Footer will be loaded here -->
</div>

<!-- Vendor JS Files -->
<script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/php-email-form/validate.js"></script>
<script src="../assets/vendor/aos/aos.js"></script>
<script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="../assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>

<!-- Main JS File -->
<script src="../assets/js/main.js"></script>
<script src="../assets/js/url.js" type="module"></script>
<script>
// Global toggleForm function
function toggleForm(formType) {
  const signInForm = document.getElementById('sign-in-form');
  const registerForm = document.getElementById('register-form');
  const signInTab = document.getElementById('signInTab');
  const registerTab = document.getElementById('registerTab');

  if (formType === 'sign-in') {
    signInForm.style.display = 'block';
    registerForm.style.display = 'none';
    signInTab.classList.add('active');
    registerTab.classList.remove('active');
  } else {
    signInForm.style.display = 'none';
    registerForm.style.display = 'block';
    signInTab.classList.remove('active');
    registerTab.classList.add('active');
  }
}

document.addEventListener("DOMContentLoaded", function() {
  // Load footer
  fetch('../footer.html')
    .then(response => response.text())
    .then(data => {
      document.getElementById('footer-container').innerHTML = data;
    })
    .catch(error => console.error('Error loading footer:', error));

  // Import URLs
  import("../assets/js/url.js").then(module => {
    const { LOGIN_URL, REGISTER_URL } = module;

    // Handle sign-in form submission
    document.getElementById('sign-in-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      // Create the request body
      const loginRequestBody = {
        username: username,
        password: password
      };

      // Make API call to Spring Boot backend
      fetch(LOGIN_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(loginRequestBody)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Login failed');
        }
        return response.json();
      })
      .then(data => {
        console.log(data);
        localStorage.setItem('userID', data.id);
        localStorage.setItem('username', data.username);
        localStorage.setItem('role', data.role);
        // Redirect to home page or dashboard
        window.location.href = '../index.html';
      })
      .catch(error => {
        console.error('Login error:', error);
        alert('Login failed. Please check your credentials and try again.');
      });
    });

    // Handle register form submission
    document.getElementById('register-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const username = document.getElementById('register-username').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;

      // Create the request body
      const registerRequestBody = {
        username: username,
        email: email,
        password: password
      };

      // Make API call to Spring Boot backend
      fetch(REGISTER_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(registerRequestBody)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Registration failed');
        }
        return response.json();
      })
      .then(data => {
        // Handle successful registration
        console.log('Registration successful:', data);
        alert('Registration successful! Please login.');
        toggleForm('sign-in');
      })
      .catch(error => {
        console.error('Registration error:', error);
        alert('Registration failed. Please try again.');
      });
    });
  });
});
</script>

</body>
</html> 